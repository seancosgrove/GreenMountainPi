# Sean Cosgrove and Emery Wollerscheid
# Green Mountain Pi
# CS 121 Final Project
# updateAntimalware.py

import os
import time

def main():

    # initialize cooldown variables
    cmdCooldown = 3 # cooldown in between os commands
    printCooldown = 1 # cooldown in between print statements

    # run rkhunter --check or not
    print("Would you like to run an antimalware scan? (y/n)") # print prompt to terminal
    response = str(input()) # get input from user
    if (str.lower(response) == "y"): # user wants to run rkhunter
        print("|==============================|") # print to terminal
        antiScanCmd = "rkhunter --check" # prepare os command
        os.system(antiScanCmd) # run os command
        time.sleep(cmdCooldown) # command cooldown
        print("Rootkit hunter scan complete") # print to terminal
        print("|==============================|") # print to terminal
        time.sleep(printCooldown) # print cooldown
    else: # user does not want to run rkhunter
        print("Loading most recent scan...") # print to terminal
        time.sleep(printCooldown) # print cooldown

    # execute getRootkitHunterLog.py
    getRootkitHunterLog = "../anti/getRootkitHunterLog.py" # get path to getRootkitHunterLog.py
    getRootkitHunterLogCmd = "python3 " + getRootkitHunterLog # prepare os command
    print("Getting rkhunter.log...") # print to terminal
    time.sleep(printCooldown) # print cooldown
    os.system(getRootkitHunterLogCmd) # run os command
    time.sleep(cmdCooldown) # command cooldown

    # execute readRootkitHunterLog.py
    readRootkitHunterLog = "../anti/readRootkitHunterLog.py" # get path to readRootkitHunterLog.py
    readRootkitHunterLogCmd = "python3 " + readRootkitHunterLog # prepare os command
    print("Reading to rootkitHunterLog.txt...") # print to terminal
    time.sleep(printCooldown) # print cooldown
    os.system(readRootkitHunterLogCmd) # run os command
    time.sleep(cmdCooldown) # command cooldown
    print("Finished writing to log text files") # build success
    time.sleep(printCooldown) # print cooldown

main()
